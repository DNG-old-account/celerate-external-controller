<head>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=geometry"></script>
</head>

<template name="subscriber_page">
<body>
  {{> celerate_navbar}}
  <div class="container-fluid">
    <div class="row">
      {{> celerate_sidebar}}

      <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        {{> subscriber_overview}}
      </div>
    </div>
  </div>
</body>
</template>

<template name="subscriber_overview">
  <div class="details">
    {{#if selected_subscriber}}
    <div id="subscriber_details_modal" class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">Ã—</button>
            <h3>Subscriber Details</h3>
          </div>
          <div class="modal-body">
            <iframe src="/subscriber_details/{{selected_subscriber._id._str}}" width="100%" frameborder="0">
            </iframe>
          </div>
          <div class="modal-footer">
            <button class="btn" data-dismiss="modal">OK</button>
          </div>
        </div>
      </div>
    </div>
    {{/if}}
  </div>

  <br><br>
  <div class="subscriber_table_header">
    <span class="glyphicon glyphicon-search"></span>
    <span class="badge">{{subscriber_count}}</span>
    <input class="subscriber_search_input" id="subscriber_search_input" type="search" placeholder="Search subscribers" value="">
    <button type="button" class="new_user_button btn btn-warning" id="new_user_button">Add New User</button>
  </div>
  <br><br>
  {{#if true}}
    {{> subscriber_map}}
  {{/if}}
  <div class="table_responsive">
    <table class="table table-striped">
      <thead><tr><th class="name_header" style="cursor:pointer;">Full Name</th><th class="status_header" style="cursor:pointer;">Status</th><th class="priority_header" style="cursor:pointer;">Priority</th><th class="address_header">Street Address</th><th class="city_header" style="cursor:pointer;">City</th><th class="community_header" style="cursor:pointer;">Community</th><th class="mapped_header" style="cursor:pointer;">Mapped</th></tr></thead>
      <tbody>
        {{#each subscribers}}
        {{> subscriber}}
        {{/each}}
      </tbody>
    </table>
  </div>

</template>

<template name="subscriber">
<tr class="subscriber {{selected}}">
  <td>{{first_name}} {{last_name}}</td>
  <td>{{status}}</td>
  <td>{{priority}}</td>
  <td>{{street_address}}</td>
  <td>{{city}}</td>
  <td>{{community}}</td>
  <td>{{#if lat}}Yes{{else}}No{{/if}}</td>
</tr>
</template>
