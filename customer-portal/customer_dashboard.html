
<template name="customer_dashboard">
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">Celerate</a>
      {{#if subscriberInfo}}
        <p class="navbar-text pull-right">Signed in as {{subscriberInfo.first_name}} {{subscriberInfo.last_name}}</p>
      {{/if}}
    </div>
  </div>
  <div class="container customer-dashboard-container">
    <div class="row">
      <div class="col-xs-12">
        <div class="page-header">
          <h1>Further Reach Customer Dashboard</h1>
        </div>
      </div>
    </div>
    {{#if loading}}
    <div class="throbber-container">
      <div id="floatingCirclesG">
        <div class="f_circleG" id="frotateG_01">
        </div>
        <div class="f_circleG" id="frotateG_02">
        </div>
        <div class="f_circleG" id="frotateG_03">
        </div>
        <div class="f_circleG" id="frotateG_04">
        </div>
        <div class="f_circleG" id="frotateG_05">
        </div>
        <div class="f_circleG" id="frotateG_06">
        </div>
        <div class="f_circleG" id="frotateG_07">
        </div>
        <div class="f_circleG" id="frotateG_08">
        </div>
      </div> 
    </div>
    {{else}}
    <div class="row">
      <div class="col-xs-12">
        {{#if subscriberInfo.plan}}
        {{else}}
        <div class="no-plan-warning-container">
          {{> plan_warning }}
        </div>
        {{/if}}
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        {{#if subscriberInfo.agreedToTerms}}
        {{else}}
        <div class="agreement-info-container">
          {{> agreement_info }}
        </div>
        {{/if}}
      </div>
    </div>
    {{#if subscriberInfo.plan}}
    <div class="row">
      <div class="col-xs-12">
        <div class="payments-info-container">
          {{> payments_info }}
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-6">
        <div class="plan-info-container">
          {{> plan_info }}
        </div>
      </div>
      <div class="col-xs-6">
        <div class="subscriber-info-container">
          {{> subscriber_info }}
        </div>
      </div>
    </div>
    {{/if}}
    {{/if}}
  </div>
  <!-- <div class="json-dump"> -->
  <!--   <pre> -->
  <!--     {{{ json subscriberInfo }}} -->
  <!--   </pre> -->
  <!-- </div> -->
</body>
</template>

<template name="subscriber_info">
<div class="panel panel-primary contact-info-panel">
  <div class="panel-heading">
    <h2>Contact Information</h2>
  </div>
  <div class="panel-body">
    <div class="col-xs-12">
      <div class="row">
        <div class="col-xs-12">
          <h3 class="sub-header">{{ subscriberInfo.first_name }} {{ subscriberInfo.last_name }}</h3>
        </div>
      </div>
      {{> contact_snippet subscriberInfo }}
      {{#if subscriberInfo.contactInfo}}
        {{#each subscriberInfo.contactInfo}}
        <h4>{{ capitalize this.type }}</h4>
        {{> contact_snippet this }}
      {{/each}}
      {{/if}}
    </div>
  </div>
</div>
</template>

<template name="contact_snippet">
{{#if showName}}
<div class="row">
  <div class="col-xs-2">
    <label>Name</label>
  </div>
  <div class="col-xs-10">
    <div>
      {{ this.first_name }} {{ this.last_name }}
    </div>
  </div>
</div>
{{/if}}
{{#if showEmail}}
<div class="row">
  <div class="col-xs-2">
    <label>Email</label>
  </div>
  <div class="col-xs-10">
    <div>
      {{#if this.prior_email}}
      {{ this.prior_email }}
      {{else}}
      {{#if this.email}}
        {{ this.email }}
      {{/if}}
      {{/if}}
    </div>
  </div>
</div>
{{/if}}
{{#if showAddress}}
<div class="row">
  <div class="col-xs-2">
    <label>Address</label>
  </div>
  <div class="col-xs-10">
    <div>
      {{ this.street_address }}
    </div>
    <div>
      {{ this.city }}, {{ this.state }} {{ this.zip_code }}
    </div>
  </div>
</div>
{{/if}}
</template>

<template name="plan_warning">
<div class="panel panel-warning">
  <div class="panel-heading">
    <h2>No Plan Selected</h2>
  </div>
  <div class="panel-body">
    <div class="col-xs-12">
      <div class="row">
        <div class="col-xs-12">
          You haven't chosen a plan! Please contact support@furtherreach.net and inform them of your choice. To see a 
          list of plans, you can visit <a href="http://furtherreach.net/#plans">FurtherReach.net</a>
        </div>
      </div>
    </div>
  </div>
</div>
</template>

<template name="agreement_info">
<div class="panel panel-warning">
  <div class="panel-heading">
    <h2>Customer Agreement</h2>
  </div>
  <div class="panel-body">
    <div class="col-xs-12">
      <div class="row">
        <div class="col-xs-12">
          You haven't agreed to the terms and conditions yet! Click below to view them.
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <button class="btn btn-success terms-conditions">Terms and Conditions</button>
        </div>
      </div>
    </div>
  </div>
</div>
</template>

<template name="payments_info">
<div class="panel panel-primary">
  <div class="panel-heading">
    <h2>Payment Info</h2>
  </div>

  <div class="panel-body">
    <div class="col-xs-12">
      {{#if requiredPayments.required }}
      <h3 class="sub-header">Make a Payment</h3>
      {{#each key_value requiredPayments.monthlyPayments}}
      {{#if value.required}}
      <div class="row payment-row">
        <div class="col-xs-5 payment-start-date">
          <div class="row">
            <div class="col-xs-12">
              Period of {{ formatDate value.startDate "MM/DD/YYYY" }} - {{ formatDate value.endDate "MM/DD/YYYY"}}
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              Plan: {{ value.label }}
            </div>
          </div>
        </div>
        <div class="col-xs-7">
          <div class="row">
            <div class="col-xs-12">
              ${{ value.amount }}
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              <button id="pay-monthly" data-index="{{key}}" class="btn btn-success pay-with-card">Pay With Credit Card</button>
            </div>
          </div>
        </div>
      </div>
      {{/if}}
      {{/each}}
      {{/if}}
      {{#if requiredPayments.installation.paid}}
      {{else}}
      <div class="row payment-row">
        <div class="col-xs-5 payment-start-date">
          <div class="row">
            <div class="col-xs-12">
              Standard Installation
            </div>
          </div>
        </div>
        <div class="col-xs-7">
          <div class="row">
            <div class="col-xs-12">
              {{#if requiredPayments.installation.installments}}
              Remaining installation amount: {{requiredPayments.installation.remaining_amount}}
              {{else}}
              ${{ requiredPayments.installation.standard_installation }}
              {{/if}}
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              {{#if requiredPayments.installation.installments}}
              <button id="pay-installation-installment" class="btn btn-warning pay-with-card">Pay Installment With Credit Card</button>
              {{else}}
              <button id="pay-installation" class="btn btn-success pay-with-card">Pay With Credit Card</button>
              <button id="pay-installation-installment" class="btn btn-warning pay-with-card">Pay Installment With Credit Card</button>
              {{/if}}
            </div>
          </div>
        </div>
      </div>
      {{/if}}
      {{#if paymentInfo}}
      {{#if showCharges }}
      <h3 class="sub-header">Previous Charges</h3>
      {{#each paymentInfo.charges}}
      <div class="row charge-row">
        <div class="col-xs-2 charge-date">
          {{ this.dateCreatedString }} 
        </div>
        <div class="col-xs-10">
          <div class="row">
            <div class="col-xs-12">
              Amount: ${{ this.dollarAmount }}
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              Description: {{ this.description }}
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              Card: {{ this.card.brand}} ending in {{ this.card.last4 }}
            </div>
          </div>
        </div>
      </div>
      {{/each}}
      {{/if}}
      {{/if}}
    </div>
  </div>
</div>
</template>

<template name="plan_info">
<div class="panel panel-primary">
  <div class="panel-heading">
    <h2>Your Plan</h2>
  </div>
  <div class="panel-body">
    <div class="col-xs-12">
      <h3 class="sub-header">{{ planInfo.label }}</h3>
      <div class="row">
        <div class="col-xs-12">
          <label>Monthly Price:</label> ${{planInfo.monthly}}
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <label>Details:</label>
          {{ planInfo.details }}
        </div>
      </div>
    </div>
  </div>
</div>
</template>
